{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jon-michaelnarvaez/stylebyjmsa/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jon-michaelnarvaez/stylebyjmsa/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jon-michaelnarvaez/stylebyjmsa/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{loadStripe}from\"@stripe/stripe-js\";// Make sure to call `loadStripe` outside of a component’s render to avoid\n// recreating the `Stripe` object on every render.\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var stripePromise=loadStripe(process.env.REACT_APP_PUBLIC_STRIPE_KEY);var ProductDisplay=function ProductDisplay(_ref){var handleClick=_ref.handleClick;return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://i.imgur.com/EHyR2nP.png\",alt:\"The cover of Stubborn Attachments\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"description\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stubborn Attachments\"}),/*#__PURE__*/_jsx(\"h5\",{children:\"$20.00\"})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",id:\"checkout-button\",role:\"link\",onClick:handleClick,children:\"Checkout\"})]});};var Message=function Message(_ref2){var message=_ref2.message;return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"p\",{children:message})});};export default function StripeCheckoutButton(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];useEffect(function(){// Check to see if this is a redirect back from Checkout\nvar query=new URLSearchParams(window.location.search);if(query.get(\"success\")){setMessage(\"Order placed! You will receive an email confirmation.\");}if(query.get(\"canceled\")){setMessage(\"Order canceled -- continue to shop around and checkout when you're ready.\");}},[]);var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var stripe,response,session,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return stripePromise;case 2:stripe=_context.sent;_context.next=5;return fetch(\"/create-checkout-session\",{method:\"POST\"});case 5:response=_context.sent;_context.next=8;return response.json();case 8:session=_context.sent;_context.next=11;return stripe.redirectToCheckout({sessionId:session.id});case 11:result=_context.sent;if(result.error){// If `redirectToCheckout` fails due to a browser or network\n// error, display the localized error message to your customer\n// using `result.error.message`.\n}case 13:case\"end\":return _context.stop();}}},_callee);}));return function handleClick(_x){return _ref3.apply(this,arguments);};}();return message?/*#__PURE__*/_jsx(Message,{message:message}):/*#__PURE__*/_jsx(ProductDisplay,{handleClick:handleClick});}","map":{"version":3,"sources":["/Users/jon-michaelnarvaez/stylebyjmsa/client/src/components/stripe-button/stripe-button-component.jsx"],"names":["React","useState","useEffect","loadStripe","stripePromise","process","env","REACT_APP_PUBLIC_STRIPE_KEY","ProductDisplay","handleClick","Message","message","StripeCheckoutButton","setMessage","query","URLSearchParams","window","location","search","get","event","stripe","fetch","method","response","json","session","redirectToCheckout","sessionId","id","result","error"],"mappings":"seAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,UAAT,KAA2B,mBAA3B,CAEA;AACA;wFACA,GAAMC,CAAAA,aAAa,CAAGD,UAAU,CAACE,OAAO,CAACC,GAAR,CAAYC,2BAAb,CAAhC,CAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,UAAGC,CAAAA,WAAH,MAAGA,WAAH,oBACrB,wCACE,aAAK,SAAS,CAAC,SAAf,wBACE,YACE,GAAG,CAAC,iCADN,CAEE,GAAG,CAAC,mCAFN,EADF,cAKE,aAAK,SAAS,CAAC,aAAf,wBACE,4CADF,cAEE,8BAFF,GALF,GADF,cAWE,eACE,IAAI,CAAC,QADP,CAEE,EAAE,CAAC,iBAFL,CAGE,IAAI,CAAC,MAHP,CAIE,OAAO,CAAEA,WAJX,sBAXF,GADqB,EAAvB,CAsBA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,WAAGC,CAAAA,OAAH,OAAGA,OAAH,oBACd,sCACE,mBAAIA,OAAJ,EADF,EADc,EAAhB,CAKA,cAAe,SAASC,CAAAA,oBAAT,EAAgC,CAC7C,cAA8BX,QAAQ,CAAC,EAAD,CAAtC,wCAAOU,OAAP,eAAgBE,UAAhB,eACAX,SAAS,CAAC,UAAM,CACd;AACA,GAAMY,CAAAA,KAAK,CAAG,GAAIC,CAAAA,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAd,CACA,GAAIJ,KAAK,CAACK,GAAN,CAAU,SAAV,CAAJ,CAA0B,CACxBN,UAAU,CAAC,uDAAD,CAAV,CACD,CACD,GAAIC,KAAK,CAACK,GAAN,CAAU,UAAV,CAAJ,CAA2B,CACzBN,UAAU,CACR,2EADQ,CAAV,CAGD,CACF,CAXQ,CAWN,EAXM,CAAT,CAYA,GAAMJ,CAAAA,WAAW,2FAAG,iBAAOW,KAAP,2KACGhB,CAAAA,aADH,QACZiB,MADY,qCAEKC,CAAAA,KAAK,CAAC,0BAAD,CAA6B,CACvDC,MAAM,CAAE,MAD+C,CAA7B,CAFV,QAEZC,QAFY,qCAKIA,CAAAA,QAAQ,CAACC,IAAT,EALJ,QAKZC,OALY,sCAOGL,CAAAA,MAAM,CAACM,kBAAP,CAA0B,CAC7CC,SAAS,CAAEF,OAAO,CAACG,EAD0B,CAA1B,CAPH,SAOZC,MAPY,eAUlB,GAAIA,MAAM,CAACC,KAAX,CAAkB,CAChB;AACA;AACA;AACD,CAdiB,uDAAH,kBAAXtB,CAAAA,WAAW,6CAAjB,CAgBA,MAAOE,CAAAA,OAAO,cACZ,KAAC,OAAD,EAAS,OAAO,CAAEA,OAAlB,EADY,cAGZ,KAAC,cAAD,EAAgB,WAAW,CAAEF,WAA7B,EAHF,CAKD","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\n// Make sure to call `loadStripe` outside of a component’s render to avoid\n// recreating the `Stripe` object on every render.\nconst stripePromise = loadStripe(process.env.REACT_APP_PUBLIC_STRIPE_KEY);\n\nconst ProductDisplay = ({ handleClick }) => (\n  <section>\n    <div className=\"product\">\n      <img\n        src=\"https://i.imgur.com/EHyR2nP.png\"\n        alt=\"The cover of Stubborn Attachments\"\n      />\n      <div className=\"description\">\n        <h3>Stubborn Attachments</h3>\n        <h5>$20.00</h5>\n      </div>\n    </div>\n    <button\n      type=\"button\"\n      id=\"checkout-button\"\n      role=\"link\"\n      onClick={handleClick}\n    >\n      Checkout\n    </button>\n  </section>\n);\nconst Message = ({ message }) => (\n  <section>\n    <p>{message}</p>\n  </section>\n);\nexport default function StripeCheckoutButton() {\n  const [message, setMessage] = useState(\"\");\n  useEffect(() => {\n    // Check to see if this is a redirect back from Checkout\n    const query = new URLSearchParams(window.location.search);\n    if (query.get(\"success\")) {\n      setMessage(\"Order placed! You will receive an email confirmation.\");\n    }\n    if (query.get(\"canceled\")) {\n      setMessage(\n        \"Order canceled -- continue to shop around and checkout when you're ready.\"\n      );\n    }\n  }, []);\n  const handleClick = async (event) => {\n    const stripe = await stripePromise;\n    const response = await fetch(\"/create-checkout-session\", {\n      method: \"POST\",\n    });\n    const session = await response.json();\n    // When the customer clicks on the button, redirect them to Checkout.\n    const result = await stripe.redirectToCheckout({\n      sessionId: session.id,\n    });\n    if (result.error) {\n      // If `redirectToCheckout` fails due to a browser or network\n      // error, display the localized error message to your customer\n      // using `result.error.message`.\n    }\n  };\n  return message ? (\n    <Message message={message} />\n  ) : (\n    <ProductDisplay handleClick={handleClick} />\n  );\n}\n"]},"metadata":{},"sourceType":"module"}